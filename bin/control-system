#!/usr/bin/env python3
from subprocess import run


options = {
    "Vérrouiller la machine": "slock",
    "Recharger i3wm": "i3-msg restart",
    "Mettre la machine en veille": "(slock&) && systemctl suspend",
    "Se déconnecter de la session...": ("Voulez-vous vraiment vous déconnecter de la session actuelle ?", "i3-msg exit"),
    "Éteindre la machine...": ("Voulez-vous vraiment éteindre la machine ?", "systemctl poweroff"),
    "Redémarrer la machine...": ("Voulez-vous vraiment redémarrer la machine ?", "systemctl reboot"),
}


selection = run(
    ["dmenu", "-l", str(len(options)), "-nb", "#ffa800", "-nf", "#0b0700"],
    input="\n".join(options),
    capture_output=True,
    encoding="UTF-8",
).stdout.removesuffix("\n")


command = options[selection]
if type(command) is tuple:
    message, command = command
    run(f"yad --undecorated --fixed --close-on-unfocus --width 400 --height 75 --text '{message}' && {command}", shell=True)
else:
    run(command, shell=True)
